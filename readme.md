# glfsjni

JNI interface to the glfs API.

# instructions

## groundwork

### maven

Get maven set up and do a first run with the *download* profile to let maven fetch all the dependencies.  Once the deps  
are downloaded we won't need the *download* profile anymore.  Run this to fetch the deps, but expect failures, and then  
move on.

        mvn -Pdownload -Pfull clean install

### glusterfs source

You'll need the glusterfs source, configured and built, in a directory.  You don't need to install from the source though.  
Later we'll need a running installation of glusterfs, but that can be from a package instead of the source.

- Compile the glusterfs source (configure & make).  We'll refer to the source tree root as <gluster>

- Set the *GLFS_HOME* environment variable to point to the libgfapi source directory

        export GLFS_HOME=<gluster>/api/src/

## the real test

To really test this you'll need a running glusterfs installation, version 3.4.

You could install from the source compiled above, or you could install a package for the running glusterfs.

- Set up a loopback interface alias, because glusterfs refuses to create a volume with a brick on *localhost* or *127.0.0.1*

        ifconfig lo:0 127.0.2.1

- Create a glusterfs volume called *foo*

        gluster volume create foo 127.0.2.1:/var/tmp/foo

- Gluster requires that clients communicate from privileged source ports, so we need to execute the test with sudo

        sudo -E mvn -Plinux64 install

- If successful, the test will have created a file called *bar* in the volume, and written *hello world* into it.

        ls -la /var/tmp/foo
        cat /var/tmp/foo/bar

- There should also be a log file generated by libgfapi in the test program, check it out

        cat glfsjni/glfsjni-linux64/target/glfsjni.log
